<div class="new-acc-main-container">
  <%= simple_form_for(@accessory, data: { controller: "accessory" }) do |f| %>
    <div class="field new-acc-flex-column-center-container">
      <h3><%= @accessory.name %></h3>
      Accessory Type
      <%= button_tag(type: 'button', class: 'btn btn-outline-secondary', id: 'change-accessory-type-button', data: { action: "click->accessory#toggleAccessoryTypeSelection" }) do %>
        <%= image_tag Accessory.image_path(@accessory.accessory_type), alt: @accessory.name, class: 'accessory-image' %>
        <%= @accessory.accessory_type %>
      <% end %>
    </div>

    <div class="field new-acc-flex-column-center-container" id="accessory-type-selection" style="display: none;">
      <div class="new-acc-main-buttons-container" data-accessory-target="buttonGroup">
        <%= button_tag(type: 'button', class: 'new-acc-main-button', data: { action: "click->accessory#showBrewingMethods", accessory_target: "brewingButton" }) do %>
          <%= image_tag "accessories/brewing_method.png", alt: "Brewing Method" %>
        <% end %>
        <%= button_tag(type: 'button', class: 'new-acc-main-button', data: { action: "click->accessory#showOtherAccessories", accessory_target: "otherButton" }) do %>
          <%= image_tag "accessories/other_accessory.png", alt: "Other Accessory" %>
        <% end %>
      </div>
    </div>

    <div class="field new-acc-flex-column-center-container" data-accessory-target="brewingMethods" style="display: none;">
      <h3>Brewing Methods</h3>
      <div class="new-acc-type-selection new-acc-flex-row-center-container">
        <% Accessory::BREWING_METHODS.each do |type| %>
          <%= image_tag "accessories/#{type.parameterize(separator: '_')}_small.png", alt: type, data: { action: "click->accessory#select", accessory_target: "accessoryImage", type: type } %>
        <% end %>
      </div>
    </div>

    <div class="field new-acc-flex-column-center-container" data-accessory-target="otherAccessories" style="display: none;">
      <h3>Other Accessories</h3>
      <div class="new-acc-type-selection new-acc-flex-row-center-container">
        <% Accessory::ACCESSORY_TYPES.reject { |type| Accessory::BREWING_METHODS.include?(type) }.each do |type| %>
          <%= image_tag "accessories/#{type.parameterize(separator: '_')}_small.png", alt: type, data: { action: "click->accessory#select", accessory_target: "accessoryImage", type: type } %>
        <% end %>
      </div>
    </div>

    <%= f.hidden_field :accessory_type, id: "accessory_type", data: { accessory_target: "accessoryType" } %>

    <div class="new-acc-flex-column-center-container">
      <div class="field" data-accessory-target="namefield">
        <div><%= f.input :name, label: "Name of your accessory", input_html: { data: { accessory_target: "name" } } %></div>
      </div>

      <div class="field" data-accessory-target="commentsField">
        <div><%= f.input :comments, label: "Comments", as: :text, input_html: { data: { accessory_target: "comments" } } %></div>
      </div>

      <div class="field" data-accessory-target="grinderFields" style="display: <%= @accessory.accessory_type == 'Grinder' ? 'block' : 'none' %>;">
        <div><%= f.input :grinder_min, label: "What is the minimal position?", input_html: { class: 'form-control prefilled-input', data: { accessory_target: "grinderMinInput" } } %></div>
        <div class="input-group new-acc-grinder-fields">
          <div class="input-group-prepend">
            <%= button_tag(type: 'button', class: 'btn btn-outline-secondary', data: { action: "click->accessory#decrementMin", target: "accessory.grinderMinButton" }) do %>
              <i class="fas fa-minus"></i>
            <% end %>
          </div>
          <div class="input-group-append">
            <%= button_tag(type: 'button', class: 'btn btn-outline-secondary', data: { action: "click->accessory#incrementMin", target: "accessory.grinderMinButton" }) do %>
              <i class="fas fa-plus"></i>
            <% end %>
          </div>
        </div>
      </div>

      <div class="field" data-accessory-target="grinderFields" style="display: <%= @accessory.accessory_type == 'Grinder' ? 'block' : 'none' %>;">
        <div><%= f.input :grinder_max, label: "What is the maximal position?", input_html: { class: 'form-control prefilled-input', data: { accessory_target: "grinderMaxInput" } } %></div>
        <div class="input-group new-acc-grinder-fields">
          <div class="input-group-prepend">
            <%= button_tag(type: 'button', class: 'btn btn-outline-secondary', data: { action: "click->accessory#decrementMax", target: "accessory.grinderMaxButton" }) do %>
              <i class="fas fa-minus"></i>
            <% end %>
          </div>
          <div class="input-group-append">
            <%= button_tag(type: 'button', class: 'btn btn-outline-secondary', data: { action: "click->accessory#incrementMax", target: "accessory.grinderMaxButton" }) do %>
              <i class="fas fa-plus"></i>
            <% end %>
          </div>
        </div>
      </div>
    </div>

    <div class="new-acc-actions-buttons">
      <%= link_to 'Back', (request.referrer || pages_dashboard_path), class: 'btn btn-outline-secondary' %>
      <div class="btn btn-warning">
        <%= link_to 'Delete accessory', accessory_path(@accessory), data: { method: :delete, confirm: "Are you sure?" } %>
      </div>
      <%= f.button :submit, class: 'btn btn-primary' %>
    </div>
  <% end %>
</div>
